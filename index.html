
<!DOCTYPE html>
<html>
   <head>
      <meta charset="utf-8">
      <script type="text/javascript">
         var data = [
            {
               img:"a.JPG",
               title:"Get this look for $110+",
               desc:"Shop this look for $68: lookastic.com/... — Grey Cowl-neck Sweater — Navy Chinos — Grey Leather Desert Boots",
               link:"https://lookastic.com/men/looks/grey-cowl-neck-sweater-navy-chinos-grey-leather-desert-boots/817"
            },
            {
               img:"b.jpg",
               title:"The Best US Cities to Visit in your 20s",
               desc:"When you think of places to go in your 20s, you may think of places like Cabo, the Bahamas, Miami, to party and forget about real life",
               link:"http://www.srtrends.com/the-best-us-cities-to-visit-in-your-20s/"
            },
            {
               img:"c.jpg",
               title:"king of Japanese Graphic design, Shigeo Fukuda",
               desc:"Photography-101 infographic cheat sheets perfect for any amateur photograper. These are really useful.",
               link:"http://www.itsnicethat.com/articles/shigeo-fukuda"
            },
            {
               img:"a.JPG",
               title:"Get this look for $110+",
               desc:"Shop this look for $68: lookastic.com/... — Grey Cowl-neck Sweater — Navy Chinos — Grey Leather Desert Boots",
               link:"https://lookastic.com/men/looks/grey-cowl-neck-sweater-navy-chinos-grey-leather-desert-boots/817"
            },
            {
               img:"b.jpg",
               title:"The Best US Cities to Visit in your 20s",
               desc:"When you think of places to go in your 20s, you may think of places like Cabo, the Bahamas, Miami, to party and forget about real life",
               link:"http://www.srtrends.com/the-best-us-cities-to-visit-in-your-20s/"
            },
            {
               img:"c.jpg",
               title:"king of Japanese Graphic design, Shigeo Fukuda",
               desc:"Photography-101 infographic cheat sheets perfect for any amateur photograper. These are really useful.",
               link:"http://www.itsnicethat.com/articles/shigeo-fukuda"
            },
            {
               img:"a.JPG",
               title:"Get this look for $110+",
               desc:"Shop this look for $68: lookastic.com/... — Grey Cowl-neck Sweater — Navy Chinos — Grey Leather Desert Boots",
               link:"https://lookastic.com/men/looks/grey-cowl-neck-sweater-navy-chinos-grey-leather-desert-boots/817"
            },
            {
               img:"b.jpg",
               title:"The Best US Cities to Visit in your 20s",
               desc:"When you think of places to go in your 20s, you may think of places like Cabo, the Bahamas, Miami, to party and forget about real life",
               link:"http://www.srtrends.com/the-best-us-cities-to-visit-in-your-20s/"
            },
            {
               img:"c.jpg",
               title:"king of Japanese Graphic design, Shigeo Fukuda",
               desc:"Photography-101 infographic cheat sheets perfect for any amateur photograper. These are really useful.",
               link:"http://www.itsnicethat.com/articles/shigeo-fukuda"
            },
            {
               img:"a.JPG",
               title:"Get this look for $110+",
               desc:"Shop this look for $68: lookastic.com/... — Grey Cowl-neck Sweater — Navy Chinos — Grey Leather Desert Boots",
               link:"https://lookastic.com/men/looks/grey-cowl-neck-sweater-navy-chinos-grey-leather-desert-boots/817"
            },
            {
               img:"b.jpg",
               title:"The Best US Cities to Visit in your 20s",
               desc:"When you think of places to go in your 20s, you may think of places like Cabo, the Bahamas, Miami, to party and forget about real life",
               link:"http://www.srtrends.com/the-best-us-cities-to-visit-in-your-20s/"
            },
            {
               img:"c.jpg",
               title:"king of Japanese Graphic design, Shigeo Fukuda",
               desc:"Photography-101 infographic cheat sheets perfect for any amateur photograper. These are really useful.",
               link:"http://www.itsnicethat.com/articles/shigeo-fukuda"
            },
            {
               img:"a.JPG",
               title:"Get this look for $110+",
               desc:"Shop this look for $68: lookastic.com/... — Grey Cowl-neck Sweater — Navy Chinos — Grey Leather Desert Boots",
               link:"https://lookastic.com/men/looks/grey-cowl-neck-sweater-navy-chinos-grey-leather-desert-boots/817"
            },
            {
               img:"b.jpg",
               title:"The Best US Cities to Visit in your 20s",
               desc:"When you think of places to go in your 20s, you may think of places like Cabo, the Bahamas, Miami, to party and forget about real life",
               link:"http://www.srtrends.com/the-best-us-cities-to-visit-in-your-20s/"
            },
            {
               img:"c.jpg",
               title:"king of Japanese Graphic design, Shigeo Fukuda",
               desc:"Photography-101 infographic cheat sheets perfect for any amateur photograper. These are really useful.",
               link:"http://www.itsnicethat.com/articles/shigeo-fukuda"
            },
            {
               img:"a.JPG",
               title:"Get this look for $110+",
               desc:"Shop this look for $68: lookastic.com/... — Grey Cowl-neck Sweater — Navy Chinos — Grey Leather Desert Boots",
               link:"https://lookastic.com/men/looks/grey-cowl-neck-sweater-navy-chinos-grey-leather-desert-boots/817"
            },
            {
               img:"b.jpg",
               title:"The Best US Cities to Visit in your 20s",
               desc:"When you think of places to go in your 20s, you may think of places like Cabo, the Bahamas, Miami, to party and forget about real life",
               link:"http://www.srtrends.com/the-best-us-cities-to-visit-in-your-20s/"
            },
            {
               img:"c.jpg",
               title:"king of Japanese Graphic design, Shigeo Fukuda",
               desc:"Photography-101 infographic cheat sheets perfect for any amateur photograper. These are really useful.",
               link:"http://www.itsnicethat.com/articles/shigeo-fukuda"
            }
         ];
      </script>

      <style type="text/css">
         body,ul,li,h4,p { margin:0; padding:0; }
         ul { margin: 20px auto; position: relative;}
         li { list-style: none; width: 200px; border: 1px solid #ddd; border-radius: 10px; overflow: hidden; box-shadow: 3px 3px 10px #eee;margin:10px; position: absolute;}
         li img { width: 100% }
         li h4 { border-bottom: 1px solid #ddd; padding:8px;}
         li p { padding: 8px; }
      </style>

      <script type="text/template">
         <li>
            <img src="img/a.jpg">
            <h4>Get this look for $110+</h4>
            <p>Shop this look for $68: lookastic.com/... — Grey Cowl-neck Sweater — Navy Chinos — Grey Leather Desert Boots</p>
         </li>
      </script>
   </head>

   <body>
      <ul></ul>
      <script type="text/javascript">
         var ul = document.getElementsByTagName("ul")[0];
         var heights;
         var line_size;
         var loading = [];
         var items = [];
         var intervalId;
         var item_width = 200;
         var item_margin = 20;

         function addItem(info) {
            var li,img,h4,p;
            li = document.createElement("li");
            img = document.createElement("img");
            img.src = "img/"+info.img;
            loading.push(img);
            h4 = document.createElement("h4");
            h4.innerHTML = info.title;
            p = document.createElement("p");
            p.innerHTML = info.desc;
            li.appendChild(img);
            li.appendChild(h4);
            li.appendChild(p);
            ul.appendChild(li);
            return li;
         }

         function getShortLine() {
            var result, short;
            short = heights[0];
            result = 0;

            for (var i=1; i < heights.length ; ++i) {
               if (heights[i] < short) {
                  short = heights[i];
                  result = i;
               }
            }
            return result;
         }

         function align() {
            var li, line;
            var new_size = getLineSize();
            var i;
            if (line_size == new_size) return;
            line_size = new_size;
            ul.style.width = (item_width*line_size + item_margin*(line_size-1))+"px";
            heights = [];
            for (i=0; i < line_size; ++i) {
               heights[i] = 0;
            }

            for (i=0; i < data.length ; ++i) {
               li = items[i];
               line = getShortLine();
               li.style.left = line*(item_width+item_margin)+"px";
               li.style.top = heights[line]+"px";
               heights[line] += li.offsetHeight+item_margin;   
            }
         }

         function getLineSize() {
            var w = document.body.offsetWidth-40;
            console.log(w);
            var size = (w+item_margin) / (item_width+item_margin);
            return Math.floor(size);
         }


         for (var i = 0 ; i < data.length ; ++i) {
            items.push(addItem(data[i]));
         }

         intervalId = setInterval(function(){
            var i = loading.length;
            while (i--) {
               if (loading[i].complete) {
                  loading.splice(i,1);
               }
            }

            if (loading.length == 0) {
               clearInterval(intervalId);
               align();
               window.onresize = align;
            }
         },100);

      </script>
   </body>
</html>